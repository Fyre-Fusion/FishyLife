<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FishyLife</title>
<style>
body{margin:0;font-family:Arial;background:#4db8ff;color:white;text-align:center;}
header{display:flex;justify-content:space-around;padding:12px;background:rgba(0,0,0,.35);}
header a{color:white;text-decoration:none;font-size:18px;}
header a.disabled{opacity:.4;pointer-events:none;}
h1{text-align:center;}
.card{
    background:rgba(0,0,0,.35);
    width:360px;
    margin:20px auto;
    padding:20px;
    border-radius:14px;
}
button{padding:8px 14px;border:none;border-radius:8px;font-weight:bold;margin:2px;cursor:pointer;}
select{padding:6px;border-radius:6px;}
#encyclopedia,#inventory,#fishing{display:none;}
.fish-card{background:rgba(255,255,255,.15);padding:6px;border-radius:6px;margin:4px 0;display:flex;justify-content:space-between;align-items:center;}
#track{width:520px;height:40px;background:#1f618d;border-radius:25px;margin:20px auto;position:relative;}
#fish{width:20px;height:20px;background:white;border-radius:50%;position:absolute;top:10px;}
#box{width:120px;height:40px;border:3px solid red;position:absolute;top:0;}
.barWrap{width:520px;height:16px;background:#222;margin:6px auto;border-radius:8px;}
.bar{height:100%;width:0%;border-radius:8px;}
#catchBar{background:lime;}
#rarityBar{background:violet;}
</style>
</head>
<body>

<header>
<a href="#" onclick="showSection('main')">ğŸ  Home</a>
<a id="fishBtn" href="#" onclick="showSection('fishing')">ğŸ£ Fish</a>
<a href="#" onclick="showSection('shop')">ğŸ›’ Shop</a>
<a href="#" onclick="toggle('inventory')">ğŸ’ Bag</a>
<a href="#" onclick="toggle('encyclopedia')">ğŸ“– Book</a>
</header>

<h1>ğŸŸ FishyLife</h1>

<div id="main" class="card-section">
    <div class="card">
        <p>â­ Level: <span id="level"></span></p>
        <p>ğŸ§ª XP: <span id="xp"></span>/<span id="xpNeed"></span></p>
        <p>ğŸ’° Money: $<span id="money"></span></p>
        <p>ğŸª± Bait: <span id="bait"></span></p>
        <p>ğŸ£ Rod Tier: <span id="rodTier"></span></p>

        <p>ğŸŒ Location:
        <select id="location" onchange="changeLocation()">
            <option value="Creek">Creek</option>
            <option value="Lake">Lake ($5000)</option>
            <option value="Ocean">Ocean ($10000)</option>
        </select>
        <button onclick="unlockLocation()">Unlock</button>
        </p>
    </div>
</div>

<div class="card" id="inventory">
<h2>ğŸ’ Inventory</h2>
<div id="invList"></div>
</div>

<div class="card" id="encyclopedia">
<h2>ğŸ“– Encyclopedia</h2>
<div id="fishList"></div>
</div>

<div class="card" id="shop" style="display:none;">
<h2>ğŸ›’ Shop</h2>

<div class="card">
<h3>ğŸ’° Money: $<span id="shopMoney"></span></h3>
</div>

<div class="card">
<h3>ğŸª± Buy Basic Bait</h3>
<p>Price: $5 per bait</p>
<input type="number" id="baitQty" value="1" min="1">
<button onclick="buyBait()">Buy</button>
</div>

<div class="card">
<h3>ğŸª± Buy Advanced Bait</h3>
<p>Price: $20 per bait</p>
<input type="number" id="advBaitQty" value="1" min="1">
<button onclick="buyAdvBait()">Buy</button>
</div>

<div class="card">
<h3>ğŸ£ Upgrade Rod</h3>
<p>Current Rod Tier: <span id="shopRodTier"></span></p>
<p>Upgrade Cost: $<span id="rodPrice"></span></p>
<button onclick="upgradeRod()">Upgrade Rod</button>
</div>
</div>

<div class="card" id="fishing">
<h2>ğŸ£ Fishing</h2>
<p>Keep the fish inside the red box to catch it!</p>
<div id="track">
    <div id="fish"></div>
    <div id="box"></div>
</div>
<div class="barWrap"><div id="catchBar" class="bar"></div></div>
<div class="barWrap"><div id="rarityBar" class="bar"></div></div>
<button id="left">â¬…ï¸</button>
<button id="right">â¡ï¸</button>
<button onclick="stopFishing()">Cancel</button>
</div>

<script>
// -------------------- GAME STATE --------------------
let g = JSON.parse(localStorage.getItem("game")) || {
    level:1, xp:0, xpNeed:50, money:50, bait:5, rod:1,
    fishCount:0, location:"Creek", inventory:{}, caught:{}, unlocked:{Creek:true,Lake:false,Ocean:false}
};

function saveGame(){ localStorage.setItem("game", JSON.stringify(g)); }

// -------------------- RENDER STATS --------------------
function showStats(){
    document.getElementById("level").textContent = g.level;
    document.getElementById("xp").textContent = g.xp;
    document.getElementById("xpNeed").textContent = g.xpNeed;
    document.getElementById("money").textContent = g.money;
    document.getElementById("bait").textContent = g.bait;
    document.getElementById("rodTier").textContent = g.rod;

    document.getElementById("shopMoney").textContent = g.money;
    document.getElementById("shopRodTier").textContent = g.rod;
    document.getElementById("rodPrice").textContent = g.rod*50;

    document.getElementById("location").value = g.location;

    document.getElementById("fishBtn").classList.toggle("disabled", !g.unlocked[g.location]);
}
showStats();

// -------------------- TOGGLE --------------------
function toggle(id){
    const e = document.getElementById(id);
    if(!e) return;
    e.style.display = (e.style.display==="block") ? "none" : "block";
    if(id==="inventory") renderInventory();
    if(id==="encyclopedia") renderFish();
}

function showSection(id){
    ["main","shop","fishing"].forEach(s=>document.getElementById(s).style.display="none");
    document.getElementById(id).style.display="block";
}

// -------------------- INVENTORY --------------------
function renderInventory(){
    const invList=document.getElementById("invList");
    invList.innerHTML="";
    for(let f in g.inventory){
        const div=document.createElement("div");
        div.className="fish-card";
        const nameSpan=document.createElement("span");
        nameSpan.textContent=`${f} x${g.inventory[f]}`;
        const sellBtn=document.createElement("button");
        sellBtn.textContent="Sell";
        sellBtn.onclick=()=>{
            const fishVal = fishData.find(x=>x.name===f)?.value || 10;
            g.inventory[f]--;
            g.money+=fishVal;
            if(g.inventory[f]<=0) delete g.inventory[f];
            saveGame();
            renderInventory();
            showStats();
        };
        div.appendChild(nameSpan);
        div.appendChild(sellBtn);
        invList.appendChild(div);
    }
}

// -------------------- ENCYCLOPEDIA --------------------
const fishData=[
{name:"Minnow",value:10},{name:"Bluegill",value:15},{name:"Bass",value:20},
{name:"Trout",value:25},{name:"Catfish",value:30},{name:"Salmon",value:40},
{name:"Golden Carp",value:60},{name:"Mythic Koi",value:100},{name:"Ancient Leviathan",value:300}
];

function renderFish(){
    const fishList=document.getElementById("fishList");
    fishList.innerHTML="";
    fishData.forEach(f=>{
        const d=document.createElement("div");
        d.className="fish-card";
        d.textContent=(g.caught[f.name]?"âœ… ":"âŒ ")+f.name;
        fishList.appendChild(d);
    });
}

// -------------------- SHOP --------------------
function buyBait(){
    const qty=parseInt(document.getElementById("baitQty").value)||1;
    const cost = qty*5;
    if(g.money<cost){ alert("Not enough money!"); return; }
    g.money-=cost;
    g.bait = (g.bait||0)+qty;
    saveGame(); showStats();
    alert(`Bought ${qty} basic bait(s)!`);
}
function buyAdvBait(){
    const qty=parseInt(document.getElementById("advBaitQty").value)||1;
    const cost=qty*20;
    if(g.money<cost){ alert("Not enough money!"); return; }
    g.money-=cost;
    g.bait = (g.bait||0) + qty*2;
    saveGame(); showStats();
    alert(`Bought ${qty} advanced bait(s)!`);
}
function upgradeRod(){
    const price=g.rod*50;
    if(g.money<price){ alert("Not enough money!"); return; }
    g.money-=price;
    g.rod++;
    saveGame(); showStats();
    alert("Rod upgraded to tier "+g.rod+"!");
}

// -------------------- LOCATION --------------------
const locationPrice={Lake:5000,Ocean:10000};
function changeLocation(){
    const loc=document.getElementById("location").value;
    if(!g.unlocked[loc]){
        alert("Location locked! Unlock it first.");
        document.getElementById("location").value=g.location;
        return;
    }
    g.location=loc; saveGame(); showStats();
}
function unlockLocation(){
    const loc=document.getElementById("location").value;
    if(g.unlocked[loc]){ alert("Already unlocked!"); return; }
    const price = locationPrice[loc]||0;
    if(g.money<price){ alert("Not enough money to unlock!"); return; }
    g.money-=price;
    g.unlocked[loc]=true; saveGame(); showStats();
    alert(loc+" unlocked!");
    document.getElementById("fishBtn").classList.remove("disabled");
}

// -------------------- FISHING --------------------
const fishByLoc={
Creek:[{name:"Minnow",xp:10,rarity:0.6},{name:"Bluegill",xp:15,rarity:0.9},{name:"Bass",xp:20,rarity:1.2}],
Lake:[{name:"Trout",xp:25,rarity:1.1},{name:"Catfish",xp:30,rarity:1.4},{name:"Salmon",xp:40,rarity:1.7}],
Ocean:[{name:"Golden Carp",xp:60,rarity:1.6},{name:"Mythic Koi",xp:100,rarity:2.0},{name:"Ancient Leviathan",xp:300,rarity:2.6}]
};

let fishingLoop=null;

function startFishing(){
    if(g.bait<=0){ alert("No bait!"); return; }
    g.bait--; saveGame(); showStats();

    const list=fishByLoc[g.location];
    const fish=list[Math.floor(Math.random()*list.length)];

    const BAR=520;
    let fishX=250, fishDir=Math.random()<0.5?-1:1;
    let boxX=200, move=0;
    let boxW=100+g.rod*10;
    document.getElementById("box").style.width = boxW+"px";

    let catchProg=0;
    const catchBar=document.getElementById("catchBar");
    const rarityBar=document.getElementById("rarityBar");
    rarityBar.style.width=(fish.rarity*35)+"%";

    document.onkeydown=e=>{ if(e.key==="ArrowLeft") move=-1; if(e.key==="ArrowRight") move=1; };
    document.onkeyup=()=>move=0;
    document.getElementById("left").onmousedown=()=>move=-1;
    document.getElementById("right").onmousedown=()=>move=1;
    document.getElementById("left").onmouseup=document.getElementById("right").onmouseup=()=>move=0;

    showSection('fishing');

    fishingLoop=setInterval(()=>{
        fishX+=fishDir*(2+fish.rarity);
        if(Math.random()<0.02) fishDir*=-1;
        if(fishX<0||fishX>BAR-20) fishDir*=-1;
        document.getElementById("fish").style.left=fishX+"px";

        boxX+=move*6;
        boxX=Math.max(0,Math.min(BAR-boxW,boxX));
        document.getElementById("box").style.left=boxX+"px";

        const center=fishX+10;
        const inside=center>boxX && center<boxX+boxW;
        if(inside) catchProg+=0.8;
        else catchProg-=0.6*fish.rarity;

        catchProg=Math.max(0,Math.min(100,catchProg));
        catchBar.style.width=catchProg+"%";

        if(catchProg>=100){
            clearInterval(fishingLoop);
            fishingLoop=null;

            g.inventory[fish.name]=(g.inventory[fish.name]||0)+1;
            g.caught[fish.name]=true;
            g.fishCount++;
            g.xp+=fish.xp;
            while(g.xp>=g.xpNeed){
                g.xp-=g.xpNeed;
                g.level++;
                g.xpNeed=Math.floor(g.xpNeed*1.5);
            }
            saveGame(); showStats();
            setTimeout(()=>{ alert("ğŸŸ You caught a "+fish.name+"!"); showSection('main'); },50);
        }
    },16);
}

function stopFishing(){
    if(fishingLoop){ clearInterval(fishingLoop); fishingLoop=null; showSection('main'); }
}

// -------------------- START --------------------
showSection('main');
</script>

<div style="text-align:center;margin-top:10px;">
<button onclick="startFishing()">Start Fishing</button>
</div>

</body>
</html>

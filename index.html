<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FishyLife</title>
<style>
body{margin:0;font-family:Arial;background:#4db8ff;color:white;}
header{display:flex;justify-content:space-around;padding:12px;background:rgba(0,0,0,.35);}
header a{color:white;text-decoration:none;font-size:18px;}
header a.disabled{opacity:.4;pointer-events:none;}
h1{text-align:center;}
.card{
    background:rgba(0,0,0,.35);
    width:360px;
    margin:20px auto;
    padding:20px;
    border-radius:14px;
}
button{padding:8px 14px;border:none;border-radius:8px;font-weight:bold;margin:2px;cursor:pointer;}
select{padding:6px;border-radius:6px;}
#encyclopedia,#inventory{display:none;}
.fish-card{background:rgba(255,255,255,.15);padding:6px;border-radius:6px;margin:4px 0;display:flex;justify-content:space-between;align-items:center;}
input[type=text]{padding:4px;border-radius:6px;border:none;width:150px;margin-right:6px;}
</style>
</head>
<body>

<header>
<a href="index.html">üè† Home</a>
<a id="fishBtn" href="fish.html">üé£ Fish</a>
<a href="shop.html">üõí Shop</a>
<a href="#" onclick="toggle('inventory')">üéí Bag</a>
<a href="#" onclick="toggle('encyclopedia')">üìñ Book</a>
</header>

<h1>üêü FishyLife</h1>

<div class="card">
<p>‚≠ê Level: <span id="level"></span></p>
<p>üß™ XP: <span id="xp"></span>/<span id="xpNeed"></span></p>
<p>üí∞ Money: $<span id="money"></span></p>
<p>ü™± Bait: <span id="bait"></span></p>
<p>üé£ Rod: <span id="rodName"></span></p>

<p>üåç Location:
<select id="location" onchange="changeLocation()">
<option value="Creek">Creek</option>
<option value="Lake">Lake</option>
<option value="Ocean">Ocean</option>
</select>
<button onclick="unlockLocation()">Unlock</button>
</p>
</div>

<div class="card">
<h2>üéü Promo Code</h2>
<input type="text" id="promoInput" placeholder="Enter code">
<button onclick="usePromo()">Redeem</button>
</div>

<div class="card" id="inventory">
<h2>üéí Inventory</h2>
<div id="invList"></div>
</div>

<div class="card" id="encyclopedia">
<h2>üìñ Encyclopedia</h2>
<div id="fishList"></div>
</div>

<!-- Hidden admin reset button -->
<button id="resetBtn" style="position:fixed;bottom:2px;right:2px;font-size:8px;padding:2px 4px;opacity:0.2;cursor:pointer;">reset</button>

<script>
// ----------- GAME DATA -------------
const fishData=[
{name:"Minnow",value:10},{name:"Bluegill",value:15},{name:"Bass",value:20},
{name:"Trout",value:25},{name:"Catfish",value:30},{name:"Salmon",value:40},
{name:"Peacock Bass",value:50},{name:"Red Snapper",value:45},{name:"Tilapia",value:35},
{name:"Clownfish",value:30},{name:"Moonfish",value:55},{name:"Tigershark",value:150},
{name:"Basa",value:40},{name:"Goldfish",value:20},{name:"Angelfish",value:22},
{name:"Turtle",value:35},{name:"Kepper",value:35},{name:"Lemonshark",value:120},
{name:"Lungfish",value:45},{name:"Squid",value:35},{name:"Crabs",value:20},{name:"Crawfish",value:15},
{name:"Mussels",value:25},{name:"Clams",value:25},{name:"Abyssal Octopus",value:500}
];

const locationPrice={Lake:5000,Ocean:10000};

const rods=[
{name:"Basic Rod",cost:0},{name:"Silver Rod",cost:200},{name:"Gold Rod",cost:400},{name:"Dark Rod",cost:600},
{name:"Reef Rod",cost:800},{name:"Lava Rod",cost:1200},{name:"Clam Rod",cost:1600},{name:"Lucky Rod",cost:1800}
];

// ----------- LOAD GAME -------------
let g;
function loadGame(){
    let saved=localStorage.getItem("game");
    if(!saved){
        g={
            level:1,xp:0,xpNeed:50,money:50,bait:5,
            rod:0,fishCount:0,location:"Creek",
            inventory:{},caught:{},
            unlocked:{Creek:true,Lake:false,Ocean:false},usedCodes:{}
        };
        localStorage.setItem("game",JSON.stringify(g));
    } else g=JSON.parse(saved);

    updateStats();
    updateLocationDropdown();
}
function updateStats(){
    level.textContent=g.level;
    xp.textContent=g.xp;
    xpNeed.textContent=g.xpNeed;
    money.textContent=g.money;
    bait.textContent=g.bait;
    rodName.textContent=rods[g.rod].name;
    document.getElementById("fishBtn").classList.toggle("disabled",!g.unlocked[g.location] || g.bait<=0);
}
loadGame();

// ----------- LOCATION DROPDOWN -------------
function updateLocationDropdown(){
    const sel=document.getElementById("location");
    for(let opt of sel.options){
        opt.disabled = !g.unlocked[opt.value];
    }
    sel.value=g.location;
}

// ----------- TOGGLE CARDS -------------
function toggle(id){
    const e=document.getElementById(id);
    if(!e) return;
    if(e.style.display==="block") e.style.display="none";
    else{
        e.style.display="block";
        if(id==="inventory") renderInventory();
        if(id==="encyclopedia") renderFish();
    }
}

// ----------- INVENTORY -------------
function renderInventory(){
    const invList=document.getElementById("invList");
    invList.innerHTML="";
    for(let f in g.inventory){
        const div=document.createElement("div");
        div.className="fish-card";
        const nameSpan=document.createElement("span");
        nameSpan.textContent=`${g.inventory[f].mutation?g.inventory[f].mutation+" ":""}${f} x${g.inventory[f].count}`;
        const sellBtn=document.createElement("button");
        sellBtn.textContent="Sell";
        sellBtn.onclick=()=>{
            if(g.inventory[f].count>0){
                const fishVal = fishData.find(x=>x.name===f)?.value || 10;
                const multiplier = g.inventory[f].multiplier || 1;
                g.inventory[f].count--;
                g.money+=Math.floor(fishVal*multiplier);
                if(g.inventory[f].count<=0) delete g.inventory[f];
                localStorage.setItem("game",JSON.stringify(g));
                renderInventory();
                updateStats();
            }
        };
        div.appendChild(nameSpan);
        div.appendChild(sellBtn);
        invList.appendChild(div);
    }
}

// ----------- ENCYCLOPEDIA -------------
function renderFish(){
    const fishList=document.getElementById("fishList");
    fishList.innerHTML="";
    fishData.forEach(f=>{
        const caught = g.caught[f.name]?"‚úÖ ":"‚ùå ";
        const div=document.createElement("div");
        div.className="fish-card";
        div.textContent=caught+f.name;
        fishList.appendChild(div);
    });
}

// ----------- LOCATION -------------
function changeLocation(){
    const loc=location.value;
    if(!g.unlocked[loc]){
        alert("Location locked! Unlock it first.");
        updateLocationDropdown();
        return;
    }
    g.location=loc;
    localStorage.setItem("game",JSON.stringify(g));
    updateStats();
}

function unlockLocation(){
    const loc=location.value;
    if(g.unlocked[loc]){
        alert("Already unlocked!");
        return;
    }
    const price=locationPrice[loc]||0;
    if(g.money<price){
        alert("Not enough money to unlock!");
        return;
    }
    g.money-=price;
    g.unlocked[loc]=true;
    localStorage.setItem("game",JSON.stringify(g));
    updateStats();
    updateLocationDropdown();
    alert(loc+" unlocked!");
}

// ----------- PROMO CODES -------------
const promoCodes={
"V7a93bXt34":()=>{ g.money+=500; g.bait+=10; g.xp+=g.xpNeed*4; },
"OvErXoWnEr010aay":()=>{ g.money+=10000; g.bait+=100; g.xp+=g.xpNeed*39; },
"T9zxPrN4GF":()=>{ g.money+=300; g.bait+=5; g.xp+=g.xpNeed*4; }
};

function usePromo(){
    const code=document.getElementById("promoInput").value;
    if(!code){alert("Enter a code!"); return;}
    if(!promoCodes[code]){alert("Invalid code!"); return;}
    if(g.usedCodes[code]){alert("You already used this code!"); return;}
    promoCodes[code]();
    g.usedCodes[code]=true;
    while(g.xp>=g.xpNeed){g.xp-=g.xpNeed; g.level++; g.xpNeed=Math.floor(g.xpNeed*1.5);}
    localStorage.setItem("game",JSON.stringify(g));
    updateStats();
    alert("Promo code applied!");
}

// ----------- RESET BUTTON -------------
document.getElementById("resetBtn").onclick=()=>{
    if(confirm("Reset all progress?")){
        localStorage.removeItem("game");
        alert("Progress reset! Reloading...");
        location.reload();
    }
};
</script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Fishing</title>
<style>
body{text-align:center;font-family:Arial;background:#4db8ff;color:white;}
#track{width:520px;height:40px;background:#1f618d;border-radius:25px;margin:30px auto;position:relative;}
#fish{width:20px;height:20px;background:white;border-radius:50%;position:absolute;top:10px;}
#box{height:40px;border:3px solid red;position:absolute;top:0;}
.bar{width:0;height:16px;background:lime;margin:auto;border-radius:8px;}
</style>
</head>
<body>

<h1>ðŸŽ£ Fishing</h1>

<div id="track">
<div id="fish"></div>
<div id="box"></div>
</div>

<div class="bar" id="bar"></div>
<p id="sizeText"></p>

<script>
let g=JSON.parse(localStorage.getItem("game"));
if(!g||g.bait<=0){location.href="index.html";}
g.bait--;

const fish={name:"Bass",xp:20,value:20,rarity:1.2};

/* ===== SIZE SYSTEM ===== */
function getSize(){
    const r=Math.random();
    if(r<0.5) return {name:"Small",mult:0.8};
    if(r<0.85) return {name:"Normal",mult:1};
    if(r<0.97) return {name:"Large",mult:1.5};
    return {name:"Giant",mult:3};
}
const size=getSize();
sizeText.textContent=`Size: ${size.name}`;

let x=250,dir=1,boxX=200,prog=0;
box.style.width="120px";

const loop=setInterval(()=>{
    x+=dir*(2+fish.rarity);
    if(x<0||x>500) dir*=-1;
    fish.style.left=x+"px";

    const inside=x>boxX&&x<boxX+120;
    prog+=inside?1:-fish.rarity;
    prog=Math.max(0,Math.min(100,prog));
    bar.style.width=prog+"%";

    if(prog>=100){
        clearInterval(loop);
        const finalName=`${size.name} ${fish.name}`;
        g.inventory[finalName]=(g.inventory[finalName]||0)+1;
        g.xp+=Math.floor(fish.xp*size.mult);
        g.money+=Math.floor(fish.value*size.mult);

        // QUEST PROGRESS
        if(g.quest){
            if(g.quest.type==="catch") g.quest.progress++;
            if(g.quest.type==="rare" && fish.rarity>=1.5) g.quest.progress++;
            if(g.quest.type==="money") g.quest.progress+=fish.value;
        }

        localStorage.setItem("game",JSON.stringify(g));
        alert("Caught "+finalName);
        location.href="index.html";
    }
},16);
</script>
</body>
</html>

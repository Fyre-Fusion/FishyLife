<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FishyLife</title>
<style>
body {
    margin:0;
    font-family:Arial, sans-serif;
    background: linear-gradient(to bottom, #004080, #001f33);
    color:white;
    text-align:center;
}
header {
    display:flex;
    justify-content:space-around;
    padding:12px;
    background:rgba(0,0,0,.35);
}
header a {
    color:white;
    text-decoration:none;
    font-size:18px;
}
h1 {
    margin-top:20px;
}
.card {
    background:rgba(0,0,0,.35);
    width:360px;
    margin:20px auto;
    padding:20px;
    border-radius:14px;
}
button {
    padding:8px 14px;
    border:none;
    border-radius:8px;
    font-weight:bold;
    margin:6px;
    cursor:pointer;
}
select {
    padding:6px;
    border-radius:6px;
}
.fish-card {
    background:rgba(255,255,255,.15);
    padding:6px;
    border-radius:6px;
    margin:4px 0;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
input[type=text] {
    padding:4px;
    border-radius:6px;
    border:none;
    width:150px;
    margin-right:6px;
}
#quests, #inventory, #encyclopedia, #skillsCard {
    display:none;
}
#fishingArea {
    margin:20px auto;
    width:360px;
    height:50px;
    background:#111;
    position:relative;
    border-radius:6px;
}
#greenBox {
    position:absolute;
    width:50px;
    height:50px;
    border:3px solid lime;
    top:0;
}
#redLine {
    position:absolute;
    width:3px;
    height:50px;
    background:red;
    top:0;
}
#progressContainer {
    margin:10px auto;
    width:360px;
    height:20px;
    background:#333;
    border-radius:10px;
}
#progressBar {
    height:100%;
    width:0%;
    background:lime;
    border-radius:10px;
}
#rarity {
    margin-top:4px;
    font-weight:bold;
}
#arrowControls button{
    font-size:18px;
    padding:6px 10px;
}
</style>
</head>
<body>

<header>
<a href="index.html">üè† Home</a>
<a href="shop.html">üõí Shop</a>
<a href="#" onclick="toggleCard('inventory')">üéí Bag</a>
<a href="#" onclick="toggleCard('encyclopedia')">üìñ Encyclopedia</a>
<a href="#" onclick="toggleCard('quests')">üéØ Quests</a>
<a href="aquarium.html">üê† Aquarium</a>
</header>

<h1>üêü FishyLife</h1>

<div class="card">
    <p>‚≠ê Level: <span id="level"></span></p>
    <p>üß™ XP: <span id="xp"></span> / <span id="xpNeed"></span></p>
    <p>üí∞ Money: $<span id="money"></span></p>
    <p>ü™± Bait: <span id="bait"></span></p>
    <p>üåç Location: 
        <select id="location" onchange="changeLocation()">
            <option value="River">River</option>
            <option value="Ocean">Ocean</option>
        </select>
    </p>
</div>

<div class="card" id="fishingCard">
    <h2>üé£ Fishing</h2>
    <div id="fishingArea">
        <div id="greenBox"></div>
        <div id="redLine"></div>
    </div>
    <div id="progressContainer">
        <div id="progressBar"></div>
    </div>
    <p id="rarity">Rarity: Common</p>
    <div id="arrowControls">
        <button onclick="moveGreen(-5)">‚¨ÖÔ∏è</button>
        <button onclick="moveGreen(5)">‚û°Ô∏è</button>
        <button onclick="startFishing()">üé£ Start</button>
    </div>
</div>

<!-- INVENTORY -->
<div class="card" id="inventory">
<h2>üéí Inventory</h2>
<div id="invList"></div>
</div>

<!-- ENCYCLOPEDIA -->
<div class="card" id="encyclopedia">
<h2>üìñ Encyclopedia</h2>
<div id="fishList"></div>
</div>

<!-- QUESTS -->
<div class="card" id="quests">
<h2>üéØ Active Quest</h2>
<div id="questInfo"></div>
</div>

<script>
// ---------------- LOAD GAME ----------------
let g = JSON.parse(localStorage.getItem("game"));
if(!g){
    g = {
        level:1, xp:0, xpNeed:50, money:15, bait:5,
        rod:"Basic Rod", location:"River",
        unlocked:{River:true,Ocean:false},
        inventory:{}, caught:{}, fishCount:0,
        skillPoints:0, skills:{},
        activeQuest:null, questProgress:{}
    };
    localStorage.setItem("game",JSON.stringify(g));
}

function updateStats(){
    document.getElementById("level").textContent = g.level;
    document.getElementById("xp").textContent = g.xp;
    document.getElementById("xpNeed").textContent = g.xpNeed;
    document.getElementById("money").textContent = g.money;
    document.getElementById("bait").textContent = g.bait;
    document.getElementById("location").value = g.location;
}

updateStats();

// ---------------- TOGGLE CARDS ----------------
function toggleCard(id){
    const el = document.getElementById(id);
    if(el.style.display==="block") el.style.display="none";
    else{
        el.style.display="block";
        if(id==="inventory") renderInventory();
        if(id==="encyclopedia") renderFish();
        if(id==="quests") renderQuest();
    }
}

// ---------------- INVENTORY ----------------
function renderInventory(){
    const invList = document.getElementById("invList");
    invList.innerHTML = "";
    for(let f in g.inventory){
        const div = document.createElement("div");
        div.className = "fish-card";
        const sellBtn = `<button onclick="sellFish('${f}')">Sell</button>`;
        div.innerHTML = `${f} x${g.inventory[f]} ${sellBtn}`;
        invList.appendChild(div);
    }
}

function sellFish(name){
    if(!g.inventory[name] || g.inventory[name]<=0) return;
    const sellPrice = 5; // could scale by rarity
    g.money += sellPrice;
    g.inventory[name]--;
    g.caught[name] = true;
    localStorage.setItem("game",JSON.stringify(g));
    renderInventory();
    renderFish();
    updateStats();
}

// ---------------- ENCYCLOPEDIA ----------------
const fishData = [
{name:"Minnow",category:"Common",location:"River"},
{name:"Bluegill",category:"Common",location:"River"},
{name:"Bass",category:"Uncommon",location:"River"},
{name:"Trout",category:"Uncommon",location:"River"},
{name:"Catfish",category:"Uncommon",location:"River"},
{name:"Salmon",category:"Rare",location:"River"},
{name:"Peacock Bass",category:"Rare",location:"River"},
{name:"Red Snapper",category:"Rare",location:"Ocean"},
{name:"Tilapia",category:"Uncommon",location:"River"},
{name:"Clownfish",category:"Uncommon",location:"Ocean"},
{name:"Moonfish",category:"Rare",location:"Ocean"},
{name:"Tigershark",category:"Legendary",location:"Ocean"},
{name:"Basa",category:"Uncommon",location:"River"},
{name:"Goldfish",category:"Common",location:"River"},
{name:"Angelfish",category:"Uncommon",location:"Ocean"},
{name:"Turtle",category:"Rare",location:"Ocean"},
{name:"Kepper",category:"Rare",location:"Ocean"},
{name:"Lemonshark",category:"Legendary",location:"Ocean"},
{name:"Lungfish",category:"Rare",location:"River"},
{name:"Squid",category:"Uncommon",location:"Ocean"},
{name:"Crabs",category:"Common",location:"Ocean"},
{name:"Crawfish Red",category:"Common",location:"River"},
{name:"Crawfish Blue",category:"Rare",location:"River"},
{name:"Pufferfish",category:"Uncommon",location:"Ocean"},
{name:"Vampire Fish",category:"Rare",location:"River"},
{name:"Japanese Spider Crab",category:"Rare",location:"Ocean"},
{name:"Carp",category:"Common",location:"River"},
{name:"Oscar",category:"Uncommon",location:"River"},
{name:"Freshwater Shark",category:"Rare",location:"River"},
{name:"Lionfish",category:"Rare",location:"Ocean"},
{name:"Prawn",category:"Common",location:"Ocean"},
{name:"Shrimp",category:"Common",location:"Ocean"},
{name:"Octopus",category:"Rare",location:"Ocean"},
{name:"Sea Urchin",category:"Uncommon",location:"Ocean"},
{name:"Salami",category:"Common",location:"Ocean"},
{name:"Sting Ray",category:"Rare",location:"Ocean"},
{name:"Dolphin",category:"Legendary",location:"Ocean"},
{name:"Blind Dolphin",category:"Legendary",location:"River"},
{name:"Stonefish",category:"Rare",location:"Ocean"},
{name:"Electric Eel",category:"Rare",location:"River"},
{name:"Red Tail Catfish",category:"Rare",location:"River"},
{name:"Tigerfish",category:"Legendary",location:"River"},
{name:"Great White Shark",category:"Legendary",location:"Ocean"},
{name:"Hammerhead Shark",category:"Legendary",location:"Ocean"},
{name:"Spine Fish",category:"Rare",location:"Ocean"},
{name:"Sea Turtle",category:"Rare",location:"Ocean"},
// add remaining river and ocean fish similarly
];

function renderFish(){
    const fishList = document.getElementById("fishList");
    fishList.innerHTML = "";
    fishData.forEach(f=>{
        const caught = g.caught[f.name] || false;
        const d = document.createElement("div");
        d.className = "fish-card";
        d.textContent = (caught?"‚úÖ ":"‚ùå ") + f.name + " [" + f.category + "]";
        fishList.appendChild(d);
    });
}

// ---------------- QUESTS ----------------
function renderQuest(){
    const card = document.getElementById("quests");
    const info = document.getElementById("questInfo");
    if(!g.activeQuest){ card.style.display="none"; return; }
    card.style.display="block";
    const fishName = g.activeQuest.fish;
    const target = g.activeQuest.target;
    const progress = g.questProgress[fishName]||0;
    info.textContent = `Catch ${target} ${fishName}: ${progress}/${target}`;
}

// ---------------- LOCATION ----------------
function changeLocation(){
    const loc = document.getElementById("location").value;
    if(!g.unlocked[loc]){
        alert("Location locked!");
        document.getElementById("location").value = g.location;
        return;
    }
    g.location = loc;
    localStorage.setItem("game",JSON.stringify(g));
    updateStats();
}

// ---------------- FISHING MECHANICS ----------------
let fishingInterval, redSpeed=2, greenPos=0, redPos=0, progress=0;
const greenBox = document.getElementById("greenBox");
const redLine = document.getElementById("redLine");
const progressBar = document.getElementById("progressBar");
const rarityLabel = document.getElementById("rarity");

function moveGreen(dx){
    greenPos = Math.min(Math.max(greenPos+dx,0),310);
    greenBox.style.left = greenPos+"px";
}

document.addEventListener("keydown",(e)=>{
    if(e.key==="ArrowLeft") moveGreen(-5);
    if(e.key==="ArrowRight") moveGreen(5);
});

function startFishing(){
    if(g.bait<=0){ alert("No bait!"); return; }
    g.bait--;
    updateStats();
    const fish = fishData[Math.floor(Math.random()*fishData.length)];
    rarityLabel.textContent = "Rarity: " + fish.category;
    redSpeed = 2 + ["Common","Uncommon","Rare","Epic","Legendary","Mythical","Godly","Secret"].indexOf(fish.category);
    progress = 0;
    progressBar.style.width = "0%";
    fishingInterval = setInterval(()=>{
        // move red line randomly
        redPos += (Math.random()*2-1)*redSpeed;
        if(redPos<0) redPos=0;
        if(redPos>357) redPos=357;
        redLine.style.left = redPos+"px";
        // check if in green box
        if(redPos>=greenPos && redPos<=greenPos+50){
            progress += 1;
        } else progress -= 2;
        if(progress>100) progress=100;
        if(progress<0) progress=0;
        progressBar.style.width = progress+"%";
        if(progress>=100){
            clearInterval(fishingInterval);
            alert(`You caught a ${fish.name}!`);
            g.inventory[fish.name] = (g.inventory[fish.name]||0)+1;
            g.caught[fish.name] = true;
            g.fishCount++;
            localStorage.setItem("game",JSON.stringify(g));
            renderInventory();
            renderFish();
            updateStats();
        }
    },50);
}
</script>

</body>
</html>
